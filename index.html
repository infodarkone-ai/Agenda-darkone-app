<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agenda Citas Dark One</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
        --color-primary: #e11d48;
        --color-secondary: #1e1e1e;
        --color-background: #121212;
        --color-input: #2a2a2a;
        --color-border: #3a3a3a;
        --color-text: #e5e5e5;
        --color-muted: #9ca3af;
    }

    body {
        font-family: 'Inter', sans-serif;
        background-color: var(--color-background);
        color: var(--color-text);
        margin: 0;
        padding: 0;
    }

    header { text-align: center; padding: 2rem 1rem; }
    header h1 { font-size: 1.75rem; font-weight: 700; color: var(--color-primary); margin: 0; }
    header p { font-size: 0.95rem; color: var(--color-muted); }

    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .dark-card { background-color: var(--color-secondary); border: 1px solid var(--color-border); box-shadow: 0 6px 12px -2px rgba(0,0,0,0.6); border-radius: 1rem; padding: 1.5rem; margin-bottom: 1.5rem; }
    .dark-input, .dark-textarea, .dark-select { width: 100%; background-color: var(--color-input); border: 1px solid var(--color-border); color: var(--color-text); padding: 0.75rem; border-radius: 0.5rem; transition: all 0.2s; font-size: 0.95rem; margin-bottom: 1rem; }
    .dark-input:focus, .dark-textarea:focus, .dark-select:focus { border-color: var(--color-primary); box-shadow: 0 0 0 2px var(--color-primary); outline: none; }
    label { font-weight: 500; color: var(--color-text); margin-bottom: 0.25rem; display: block; }

    .btn-primary { background-color: var(--color-primary); color: #fff; font-weight: 600; border-radius: 0.5rem; padding: 0.75rem 1rem; transition: background-color 0.2s ease; border: none; width: 100%; cursor: pointer; font-size: 1rem; }
    .btn-primary:hover { background-color: #be123c; }

    .whatsapp-util-button, .calendar-util-button { display: inline-flex; align-items: center; font-size: 0.875rem; font-weight: 600; color: #fff; padding: 0.5rem 0.75rem; border-radius: 0.5rem; transition: all 0.15s; cursor: pointer; margin-top: 0.5rem; text-decoration: none; }
    .whatsapp-util-button { background-color: #22c55e; }
    .whatsapp-util-button:hover { background-color: #16a34a; }
    .calendar-util-button { background-color: #3b82f6; margin-left: 0.5rem; }
    .calendar-util-button:hover { background-color: #2563eb; }

    #outputContainer { background-color: var(--color-secondary); border: 1px solid var(--color-border); padding: 1rem; border-radius: 0.75rem; margin-top: 1.5rem; }
    h2, h3 { color: var(--color-primary); margin-top: 0; }
  </style>
</head>
<body>

<header>
  <h1>Agenda Citas Dark One</h1>
  <p>Sistema para agendar citas, generar mensajes y compartir enlaces.</p>
</header>

<div class="container">
  <div class="dark-card">
    <h2>Detalles de la Cita</h2>
    <label for="cliente">Nombre Cliente *</label>
    <input type="text" id="cliente" class="dark-input" placeholder="Nombre Completo">

    <label for="servicio">Servicio *</label>
    <select id="servicio" class="dark-select">
      <option>Tatuaje</option>
      <option>Piercing</option>
      <option>Micropigmentación</option>
    </select>

    <label for="whatsapp">WhatsApp (Incluir prefijo) *</label>
    <input type="text" id="whatsapp" class="dark-input" placeholder="+569">

    <label for="correo">Correo Cliente *</label>
    <input type="email" id="correo" class="dark-input" placeholder="correo@gmail.com">

    <label for="abono">Abono (CLP$)</label>
    <input type="number" id="abono" class="dark-input" placeholder="Ej: 50000">

    <label for="descripcion">Descripción / Notas Específicas (Se añade al Calendar)</label>
    <textarea id="descripcion" class="dark-textarea" rows="3" placeholder="Ej: Diseño de dragón en hombro. Medidas 15x10cm."></textarea>
  </div>

  <div class="dark-card">
    <h2>Fecha y Horario</h2>
    <label for="fecha">Fecha *</label>
    <input type="date" id="fecha" class="dark-input">
    <label for="hora-inicio">Hora de Inicio (15:00 por defecto)</label>
    <input type="time" id="hora-inicio" class="dark-input" value="15:00">
    <label for="hora-fin">Hora de Término (30 min)</label>
    <input type="time" id="hora-fin" class="dark-input" value="15:30">
  </div>

  <button class="btn-primary">📅 GENERAR MENSAJE Y ENLACES</button>

  <div id="outputContainer" class="dark-card" style="display:none;">
    <h3>Resultado</h3>
    <p id="outputText"></p>
    <div>
      <button class="whatsapp-util-button">💬 Enviar por WhatsApp</button>
      <button class="calendar-util-button">📆 Abrir en Calendar</button>
    </div>
  </div>
</div>

<script>
function generarEvento() {
    const cliente = document.getElementById("cliente").value.trim();
    const servicio = document.getElementById("servicio").value.trim();
    const correosInput = document.getElementById("correo").value.trim();
    const whatsapp = document.getElementById("whatsapp").value.trim();
    const abono = document.getElementById("abono").value.trim();
    const descripcion = document.getElementById("descripcion").value.trim();
    const fecha = document.getElementById("fecha").value;
    const horaInicio = document.getElementById("hora-inicio").value;
    const horaFin = document.getElementById("hora-fin").value;

    if (!cliente || !servicio || !correosInput || !whatsapp || !fecha) {
        alert("Por favor, complete todos los campos obligatorios (*)");
        return;
    }

    const correos = correosInput.split(",").map(c => c.trim()).filter(c => c !== "");

    let tituloEvento = `${servicio}`;
    if (descripcion) tituloEvento += ` / ${descripcion}`;
    tituloEvento += ` / ${cliente}`;
    if (abono) tituloEvento += ` / $${abono}`;

    const fechaInicio = new Date(`${fecha}T${horaInicio}:00`);
    const fechaFin = new Date(`${fecha}T${horaFin}:00`);

    function formatDate(d) {
        return d.toISOString().replace(/-|:|\.\d+/g, "");
    }

    const start = formatDate(fechaInicio);
    const end = formatDate(fechaFin);

    let descripcionEvento = `⭐ ${cliente} / Gracias por preferirnos ⭐\nTu cita está agendada\n\n`;
    descripcionEvento += `Información esencial:\n${descripcion}\n\n`; 
    descripcionEvento += `Datos de la cita:\n👤 Cliente: ${cliente}\n💉 Servicio: ${servicio}\n📅 Fecha: ${fecha} de ${horaInicio} a ${horaFin}\n💰 Abono: $${abono || "0"}\n📧 Correo(s): ${correos.join(", ")}\n📲 WhatsApp: ${whatsapp}`;

    let calendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(tituloEvento)}&dates=${start}/${end}&details=${encodeURIComponent(descripcionEvento)}`;
    if (correos.length > 0) {
        correos.forEach(c => {
            calendarUrl += `&add=${encodeURIComponent(c)}`;
        });
    }

    const mensajeWhatsApp = `👋 Hola ${cliente}, te agendé para ${servicio}.\n📅 Fecha: ${fecha} ${horaInicio} a ${horaFin}\n💰 Abono: $${abono || "0"}\n📧 Se envió invitación al correo: ${correos.join(", ")}\n\nEnlace a tu cita: ${calendarUrl}`;

    const whatsappUrl = `https://wa.me/${whatsapp}?text=${encodeURIComponent(mensajeWhatsApp)}`;

    document.getElementById("outputContainer").style.display = "block";
    document.getElementById("outputText").innerText = mensajeWhatsApp;

    const whatsappBtn = document.querySelector(".whatsapp-util-button");
    whatsappBtn.onclick = () => window.open(whatsappUrl, "_blank");

    const calendarBtn = document.querySelector(".calendar-util-button");
    calendarBtn.onclick = () => window.open(calendarUrl, "_blank");
}

document.querySelector(".btn-primary").addEventListener("click", generarEvento);
</script>

</body>
</html>
